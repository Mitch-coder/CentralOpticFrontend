<mat-sidenav-container class="example-container">
    <mat-sidenav-content>
        <div class="example-content">
            <section *ngIf="getEventBtnClickHeader()">
                <section *ngIf="!dataUpdate">
                    <h1>Lista de factura</h1>
                    <app-table [data]="myData$" [columns]="tableColumns" (selectItemsCell)="setDataUpdate($event)"
                        [buttonShowInfo]="true" (selectItemsCellInfo)="setInfoData($event,info)"></app-table>
                </section>
                <section *ngIf="dataUpdate">
                    <ng-container *ngTemplateOutlet="formUpdate">
                    </ng-container>
                </section>
            </section>
            <section *ngIf="!getEventBtnClickHeader()">
                <ng-container *ngTemplateOutlet="formCreate">
                </ng-container>
            </section>
        </div>

    </mat-sidenav-content>
</mat-sidenav-container>





<ng-template #formCreate>
    <div class="card">
        <div class="card-body">
            <div class="container-header">
                <h1 class="title">
                    Agregar información de la Factura
                </h1>
            </div>
            <form [formGroup]="formCreateData">

                <div class="content-select">
                    <div class="mb-2 container-select" #input>
                        <label class="form-label">
                            Empleado
                        </label>
                        <input type="text" formControlName="empleado" class="form-control form-input"
                            placeholder="Seleccione el empleado" [(ngModel)]="Empleado.nombres" readonly>
                        <i class="fa-solid fa-user-tie form-input-icon"></i>
                        <div class="alert 1alert-danger mt-1"
                            [hidden]="formGetDataCreate('empleado').valid || (formGetDataCreate('empleado').pristine)">
                            El campo no puede estar vacío
                        </div>
                    </div>
                    <button mat-fab extended class="btn-add btn-primary" (click)="openDialogWithTemplate(empleado)">
                        <!-- <i class="fa-regular fa-hand-pointer"></i> -->
                        <i class="fa-solid fa-users-line"></i>
                    </button>
                </div>

                <div class="content-select">
                    <div class="mb-2 container-select" #input>
                        <label class="form-label">
                            Cliente
                        </label>
                        <input type="text" formControlName="cliente" class="form-control form-input"
                            placeholder="Seleccione el cliente" [(ngModel)]="Cliente.nombres" readonly>
                        <!--[(ngModel)]="OjoIzquierdo">-->
                        <i class="fa-regular fa-circle-user form-input-icon"></i>
                        <div class="alert 1alert-danger mt-1"
                            [hidden]="formGetDataCreate('cliente').valid || (formGetDataCreate('cliente').pristine)">
                            El campo no puede estar vacío
                        </div>
                    </div>
                    <button mat-fab extended class="btn-add btn-primary" (click)="openDialogWithTemplate(cliente)">
                        <!-- <i class="fa-regular fa-hand-pointer"></i> -->
                        <i class="fa-solid fa-users-rectangle"></i>
                    </button>
                </div>

                <div class="container-header">
                    <h1 class="title">
                        Productos
                    </h1>
                    <button mat-fab extended class="btnProducto btn-primary"
                        (click)="openDialogWithTemplate(selectType)">
                        Añadir producto
                        <i class="fa-solid fa-cart-plus"></i>
                    </button>
                </div>

                <!-- <ng-container *ngTemplateOutlet="pp2">

                </ng-container> -->

                <div class="mb-2" *ngIf="detalleFacturaItems.length>0">
                    <!-- <app-table-input [data]="detalleFacturaItems">

                    </app-table-input> -->
                    <ng-container *ngTemplateOutlet="table">

                    </ng-container>
                </div>

                <div class="mb-2" #input>
                    <label class="form-label">
                        Fecha Emisión
                    </label>
                    <input type="text" formControlName="fechaEmision" class="form-control form-input"
                        placeholder="Fecha de emision" [(ngModel)]="FechaFactura.fechaEmision" readonly>
                    <i class="fa-solid fa-calendar-days form-input-icon"></i>
                    <div class="alert 1alert-danger mt-1"
                        [hidden]="formGetDataCreate('fechaEmision').valid || (formGetDataCreate('fechaEmision').pristine)">
                        La Fecha no puede estar vacía
                    </div>
                </div>


                <div class="container-header">
                    <div class="mb-2 form-content-input" #input>
                        <label class="form-label">
                            Descuento *
                        </label>
                        <input type="number" formControlName="descuento" class="form-control form-input"
                            placeholder="Digite el descuento" [(ngModel)]="Factura.descuento"
                            (ngModelChange)="Calcular()">
                        <!-- <i class="fa-solid fa-glasses form-input-icon"></i> -->
                        <i class="fa-solid fa-coins form-input-icon"></i>
                        <div class="alert alert-danger mt-1"
                            [hidden]="formGetDataCreate('descuento').valid || (formGetDataCreate('descuento').pristine)">
                            El descuento no puede estar vacío
                        </div>
                    </div>
                    <div class="mb-2 form-content-input" #input>
                        <label class="form-label">
                            Impuesto*
                        </label>
                        <input type="number" formControlName="impuesto" class="form-control form-input"
                            placeholder="Digite el Impuesto" [(ngModel)]="Factura.impuestos"
                            (ngModelChange)="Calcular()">
                        <!-- <i class="fa-solid fa-glasses "></i> -->
                        <i class="fa-solid fa-coins form-input-icon"></i>
                        <div class="alert alert-danger mt-1"
                            [hidden]="formGetDataCreate('impuesto').valid || (formGetDataCreate('impuesto').pristine)">
                            El impuesto no puede estar vacío
                        </div>
                    </div>
                </div>

                <div class="mb-2" #input>
                    <label class="form-label">
                        Subtotal
                    </label>
                    <input type="number" formControlName="subtotal" class="form-control form-input"
                        placeholder="Subtotal" [(ngModel)]="Subtotal" readonly>
                    <!-- <i class="fa-solid fa-glasses "></i> -->
                    <i class="fa-solid fa-dollar-sign form-input-icon"></i>
                    <!-- <div class="alert alert-danger mt-1"
                        [hidden]="formGetDataCreate('monto').valid || (formGetDataCreate('monto').pristine)">
                        El monto no puede estar vacio
                    </div> -->
                </div>

                <div class="mb-2" #input>
                    <label class="form-label">
                        Total
                    </label>
                    <input type="number" formControlName="total" class="form-control form-input" placeholder="Total"
                        [(ngModel)]="Total" readonly>
                    <!-- <i class="fa-solid fa-glasses "></i> -->
                    <i class="fa-solid fa-dollar-sign form-input-icon"></i>
                    <!-- <div class="alert alert-danger mt-1"
                        [hidden]="formGetDataCreate('monto').valid || (formGetDataCreate('monto').pristine)">
                        El monto no puede estar vacio
                    </div> -->
                </div>

                <div class="mb-2" #input>
                    <label class="form-label">
                        Monto pagado
                    </label>
                    <input type="number" formControlName="monto" class="form-control form-input"
                        placeholder="Monto pagado" [(ngModel)]="Pago.monto">
                    <!-- <i class="fa-solid fa-glasses "></i> -->
                    <i class="fa-solid fa-dollar-sign form-input-icon"></i>
                    <!-- <div class="alert alert-danger mt-1"
                        [hidden]="formGetDataCreate('monto').valid || (formGetDataCreate('monto').pristine)">
                        El monto no puede estar vacio
                    </div> -->
                </div>



                <button class="btn btn-primary" #btnEnviar [disabled]="formCreateData.invalid"
                    (click)="loadConfirmationDataCreate()">
                    Agregar
                </button>

            </form>

        </div>
    </div>
</ng-template>


<!-- la tabla que mostrara los datos -->
<ng-template #table>
    <div class="table-container">
        <table mat-table [dataSource]="detalleFacturaItemsList" matSort>
            <ng-container matColumnDef="id">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> ID </th>
                <td mat-cell *matCellDef="let row"> {{row.id}} </td>
            </ng-container>

            <ng-container matColumnDef="tipoItems">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Tipo </th>
                <td mat-cell *matCellDef="let row"> {{row.tipoItems}}</td>
            </ng-container>

            <ng-container matColumnDef="codProducto">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Producto </th>
                <td mat-cell *matCellDef="let row"> {{row.codProducto}}</td>
            </ng-container>

            <ng-container matColumnDef="descripcion">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Descripción </th>
                <td mat-cell *matCellDef="let row"> {{row.descripcion}}</td>
            </ng-container>

            <ng-container matColumnDef="cantidad">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Cantidad </th>
                <td mat-cell *matCellDef="let row"> {{row.cantidad}}</td>
            </ng-container>

            <ng-container matColumnDef="precioUni">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Precio </th>
                <td mat-cell *matCellDef="let row"> {{row.precioUni}}</td>
                <td mat-footer-cell *matFooterCellDef> {{ 0 }} </td>
            </ng-container>

            <ng-container matColumnDef="action">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Action </th>
                <td mat-cell *matCellDef="let row">
                    <button mat-icon-button color="primary" (click)="openEditForm(row,updateItems)">
                        <mat-icon>edit</mat-icon>
                    </button>
                    <button mat-icon-button color="warn" (click)="deleteEmployee(row)">
                        <mat-icon>delete</mat-icon>
                    </button>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            <!-- <tr mat-footer-row *matFooterRowDef="displayedColumns; sticky: true"></tr> -->
        </table>
    </div>

</ng-template>

<ng-template #updateItems>
    <div class="card">
        <div class="card-body">
            <div class="container-header">
                <h1 class="title">
                    Actualizar información del producto
                </h1>
                <button mat-fab extended class="btnUpdate btn-danger" (click)="cancelDialogResult()">
                    Cerrar
                    <i class="fa-solid fa-xmark"></i>
                </button>
            </div>
            <form [formGroup]="formUpdateItems">

                <div class="mb-2" #input>
                    <label class="form-label">
                        Producto
                    </label>
                    <input type="text" formControlName="descripcion" class="form-control form-input"
                        placeholder="Ingrese el producto" [(ngModel)]="detalleItems.descripcion" readonly>
                    <i class="fa-solid fa-calendar-days form-input-icon"></i>
                    <div class="alert 1alert-danger mt-1"
                        [hidden]="formGetDataUpdateItems('descripcion').valid || (formGetDataUpdateItems('descripcion').pristine)">
                        El producto no puede estar vacío
                    </div>
                </div>

                <div class="mb-2" #input>
                    <label class="form-label">
                        Cantidad
                    </label>
                    <input type="number" formControlName="cantidad" class="form-control form-input"
                        placeholder="Ingrese la cantidad de productos a facturar" [(ngModel)]="detalleItems.cantidad">
                    <i class="fa-solid fa-calendar-days form-input-icon"></i>
                    <div class="alert 1alert-danger mt-1"
                        [hidden]="formGetDataUpdateItems('cantidad').valid || (formGetDataUpdateItems('cantidad').pristine)">
                        La cantidad no puede estar vacía
                    </div>
                </div>

                <div class="mb-2" #input>
                    <label class="form-label">
                        Precio unitario
                    </label>
                    <input type="number" formControlName="precioUni" class="form-control form-input"
                        placeholder="Ingrese el precion unitario" [(ngModel)]="detalleItems.precioUni">
                    <i class="fa-solid fa-glasses form-input-icon"></i>
                    <div class="alert alert-danger mt-1"
                        [hidden]="formGetDataUpdateItems('precioUni').valid || (formGetDataUpdateItems('precioUni').pristine)">
                        El precio no puede estar vacío
                    </div>
                </div>

                <button class="btn btn-primary" #btnEnviar [disabled]="formUpdateItems.invalid"
                    (click)="loadConfirmationUpdateItem()">
                    Actualizar
                </button>
            </form>
        </div>
    </div>
</ng-template>

<!-- 

    'id',
    'tipoItems',
    'codProducto',
    'descripcion',
    'cantidad',
    'precioUni',
    'action'

 -->


<!-- <ng-template #pp2>
    <div class="container-products mb-2">
        <div class="content-products">
            <h2 class="items items-id">
                ID
            </h2>
            <h2 class="items items-type">
                Tipo
            </h2>
            <h2 class="items items-descripcion">
                Descripcion
            </h2>
            <h2 class="items items-cantidad">
                Cantidad
            </h2>
            <h2 class="items items-precio">
                Precio
            </h2>
            <h2 class="items items-precio">
                Accion
            </h2>
        </div>

        <ng-container *ngFor="let element of detalleFacturaItems">
            <div>

            </div>
        </ng-container>
    </div>
</ng-template> -->


<!-- clientes -->
<ng-template #cliente>
    <app-table-simple [data]="clienteList" [columns]="tableColumnsCliente"
        (selectItemsCell)="resultDataTableCliente($event)" (cancelTable)="cancelDialogResult()">
    </app-table-simple>
</ng-template>

<!-- Empleado -->
<ng-template #empleado>
    <app-table-simple [data]="empleadoList" [columns]="tableColumnsEmpleado"
        (selectItemsCell)="resultDataTableEmpleado($event)" (cancelTable)="cancelDialogResult()">
    </app-table-simple>
</ng-template>

<!-- ordenPedido -->
<ng-template #ordenPedido>
    <app-table-simple [data]="tableDataOrdenPedido" [columns]="tableColumnsOrdenPedido"
        (selectItemsCell)="resultDataTableOrdenPedido($event)" (cancelTable)="cancelDialogResult()">
    </app-table-simple>
</ng-template>

<!-- producto -->
<ng-template #producto>
    <app-table-simple [data]="tableDataProducto" [columns]="tableColumnsProducto"
        (selectItemsCell)="resultDataTableProducto($event)" (cancelTable)="cancelDialogResult()">
    </app-table-simple>
</ng-template>


<!-- productos -->

<ng-template #selectType>
    <div class="">

        <div class="container-header">
            <button class="btnType formInputType" [ngClass]="getBtnClick('left')" (click)="setBtnClick('left')">

                <strong *ngIf="getBtnClick('left') === 'active'">Productos</strong>
                <div *ngIf="getBtnClick('rigth') === 'active'">Productos</div>


            </button>

            <button class="btnType formInputType" [ngClass]="getBtnClick('rigth')" (click)="setBtnClick('rigth')">

                <strong *ngIf="getBtnClick('rigth') === 'active'">Pedidos</strong>
                <div *ngIf="getBtnClick('left') === 'active'">Pedidos</div>

            </button>
        </div>
        <section *ngIf="getBtnClick('left') === 'active'">
            <ng-container *ngTemplateOutlet="producto">

            </ng-container>
        </section>
        <section *ngIf="getBtnClick('rigth') === 'active'">
            <ng-container *ngTemplateOutlet="ordenPedido">

            </ng-container>
        </section>
    </div>
</ng-template>


<ng-template #formUpdate>
    <div class="card">
        <div class="card-body">
            <div class="container-header">
                <h1 class="title">
                    Actualizar información de la factura
                </h1>
                <button mat-fab extended class="btnUpdate btn-danger" (click)="cancelFormUpdate()">
                    Cerrar
                    <i class="fa-solid fa-xmark"></i>
                </button>
            </div>
            <form [formGroup]="formDataUpdate">

                <div class="mb-2">
                    <mat-label class="form-label">
                        Estado del producto
                    </mat-label>
                    <mat-select formControlName="estadoFactura" class="form-control form-control-lg" matNativeControl
                        [(ngModel)]="EstadoFactura.idEstadoFactura">
                        <mat-option *ngFor="let option of facturaEstadoList" [value]="option.idEstadoFactura">
                            {{option.estadoFactura}}
                        </mat-option>
                    </mat-select>
                </div>

                <button class="btn btn-primary" #btnEnviar [disabled]="formDataUpdate.invalid"
                    (click)="loadConfirmationDataUpdate()">
                    Actualizar
                </button>
            </form>
        </div>
    </div>
</ng-template>

<ng-template #info>
    <div class="container-info">
        <div class="row">
            <div class="col">
                <hr>
                <br>
                <h1> <strong>Información de la factura</strong></h1>
                <hr>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <span class="span">
                    <p class="p">Emisor: </p> {{Empleado.nombres +' '+ Empleado.apellidos}}
                </span>
            </div>
            <div class="col">
                <span class="span">
                    <p class="p">Número de Factura: </p> {{Factura.numFactura}}
                </span>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <span class="span">
                    <p class="p">Cliente: </p>{{Cliente.nombres+' '+ Cliente.apellidos}}
                </span>
            </div>
            <div class="col">
                <span class="span">
                    <p class="p">Estado de la factura: </p> {{EstadoFactura.estadoFactura}}
                </span>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <span class="span">
                    <p class="p">Fecha de emisión: </p> {{fechadetallefactura}}
                </span>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <span class="span">
                    <p class="p">Productos:</p>
                </span>
            </div>
        </div>
        <hr>
        <div class="row">
            <div class="col">
                <ng-container *ngTemplateOutlet="tableInfo"></ng-container>
            </div>
        </div>
        <hr>
        <div class="row">
            <div class="col">
                <span class="span">
                    <p class="p">Impuesto:</p> {{Factura.impuestos}}

                </span>
            </div>
            <div class="col">
                <span class="span">
                    <p class="p">Descuento:</p> {{Factura.descuento}}
                </span>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <span class="span">
                    <p class="p">Sub-Total:</p> {{Subtotal}}
                </span>
            </div>
            <div class="col">
                <span class="span">
                    <p class="p">Total:</p> {{Total}}
                </span>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <span class="span">
                    <p class="p">Pagado:</p> {{Pago.monto}}
                </span>
            </div>
            <div class="col">
                <span class="span">
                    <button class="btn btn-primary" #btnEnviar (click)="cancelDialogResult()">
                        OK
                    </button>
                </span>
            </div>
        </div>

        <!-- <span class="span">
            <p class="p">Pagado:</p> {{Pago.monto}}
        </span>
        <button class="btn btn-primary" #btnEnviar (click)="cancelDialogResult()">
            OK
        </button> -->
    </div>
</ng-template>


<!-- la tabla que mostrara los datos -->
<ng-template #tableInfo>
    <div class="table-container">
        <table mat-table [dataSource]="detalleFacturaInfo" matSort>
            <!-- <ng-container matColumnDef="id">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> ID </th>
                <td mat-cell *matCellDef="let row"> {{row.id}} </td>
            </ng-container>

            <ng-container matColumnDef="tipoItems">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Tipo </th>
                <td mat-cell *matCellDef="let row"> {{row.tipoItems}}</td>
            </ng-container> -->

            <ng-container matColumnDef="codProducto">
                <th mat-header-cell *matHeaderCellDef> Código del Producto </th>
                <td mat-cell *matCellDef="let row"> {{row.codProducto}}</td>
            </ng-container>

            <ng-container matColumnDef="descripcion">
                <th mat-header-cell *matHeaderCellDef> Descripción </th>
                <td mat-cell *matCellDef="let row"> {{row.descripcion}}</td>
            </ng-container>

            <ng-container matColumnDef="cantidad">
                <th mat-header-cell *matHeaderCellDef> Cantidad </th>
                <td mat-cell *matCellDef="let row"> {{row.cantidad}}</td>
            </ng-container>

            <ng-container matColumnDef="precioUni">
                <th mat-header-cell *matHeaderCellDef> Precio </th>
                <td mat-cell *matCellDef="let row"> {{row.precioUni}}</td>
                <td mat-footer-cell *matFooterCellDef> {{ 0 }} </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayColumnInfo"></tr>
            <tr mat-row *matRowDef="let row; columns: displayColumnInfo;"></tr>
            <!-- <tr mat-footer-row *matFooterRowDef="displayedColumns; sticky: true"></tr> -->
        </table>
    </div>

</ng-template>